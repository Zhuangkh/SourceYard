<Project>
  <Target Name="SourceYard" AfterTargets="CoreCompile">
    <PropertyGroup>
      <SourcePackingDirectory>$(IntermediateOutputPath)SourcePacking\</SourcePackingDirectory>

      <CompileTextFile>$(SourcePackingDirectory)CompileFile.txt</CompileTextFile>
      <ResourceTextFile>$(SourcePackingDirectory)ResourceFile.txt</ResourceTextFile>
      <ContentTextFile>$(SourcePackingDirectory)ContentFile.txt</ContentTextFile>
      <PageTextFile>$(SourcePackingDirectory)PageFile.txt</PageTextFile>
      <ApplicationDefinitionTextFile>$(SourcePackingDirectory)ApplicationDefinitionFile.txt</ApplicationDefinitionTextFile>
    </PropertyGroup>

    <MakeDir Condition="!Exists($(SourcePackingDirectory))" Directories="$(SourcePackingDirectory)"></MakeDir>

    <WriteLinesToFile File="$(CompileTextFile)" Lines="@(Compile)" Overwrite="true" />
    <WriteLinesToFile File="$(ResourceTextFile)" Lines="@(Resource)" Overwrite="true" />
    <WriteLinesToFile File="$(ContentTextFile)" Lines="@(Content)" Overwrite="true" />
    <WriteLinesToFile File="$(PageTextFile)" Lines="@(Page)" Overwrite="true" />
    <WriteLinesToFile File="$(ApplicationDefinitionTextFile)" Lines="@(ApplicationDefinition)" Overwrite="true" />

    <PropertyGroup>
   
      <SourceYardAuthors Condition="$(Authors) != ''"> --Authors $(Authors) </SourceYardAuthors>
      <SourceYardRepositoryUrl Condition="$(RepositoryUrl) != ''" > --RepositoryUrl $(RepositoryUrl)</SourceYardRepositoryUrl>
      <SourceYardRepositoryType Condition="$(RepositoryType) != ''" > --RepositoryType $(RepositoryType)</SourceYardRepositoryType>
      <SourceYardPackageProjectUrl Condition="$(PackageProjectUrl) != ''" > --PackageProjectUrl $(PackageProjectUrl)</SourceYardPackageProjectUrl>
      <SourceYardCopyright Condition="$(Copyright) != ''" > --Copyright $(Copyright)</SourceYardCopyright>
      <SourceYardDescription Condition="$(Description) != ''" > --Description $(Description)</SourceYardDescription>

    </PropertyGroup>

    <Exec Command="$(MSBuildThisFileDirectory)..\tools\net45\dotnetCampus.SourceYard.exe -p $(MSBuildProjectFullPath) -i $(IntermediateOutputPath) -n $(PackageOutputPath) -v $(PackageVersion) --Compile $(CompileTextFile) --Resource $(ResourceTextFile) --Content $(ContentTextFile) --Page $(PageTextFile) --ApplicationDefinition $(ApplicationDefinitionTextFile) $(SourceYardAuthors) $(SourceYardRepositoryUrl) $(SourceYardRepositoryType) $(SourceYardPackageProjectUrl) $(SourceYardCopyright) $(SourceYardDescription)"></Exec>
  </Target>
</Project>